<?xml version="1.0" encoding="UTF-8"?>
<beans:beans
       xmlns:beans="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns="http://www.springframework.org/schema/integration"
       xmlns:int-htpp="http://www.springframework.org/schema/integration/http"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.springframework.org/schema/integration
       http://www.springframework.org/schema/integration/spring-integration.xsd
       http://www.springframework.org/schema/integration/http
       http://www.springframework.org/schema/integration/http/spring-integration-http.xsd">


    <beans:bean id="channelHandler" class="kg.infocom.util.ChannelHandler"/>

    <int-htpp:inbound-gateway
            supported-methods="GET"
            request-channel="requestChannel"
            reply-channel="replyChannel"
            path="/services/{pin}"
            payload-expression="#pathVariables.pin">
        <!--<int-htpp:request-mapping produces="application/json"/>-->
    </int-htpp:inbound-gateway>

    <int-htpp:inbound-gateway
            supported-methods="GET"
            request-channel="requestChannelCatalog"
            reply-channel="replyChannelCatalog"
            path="/services/catalog/{name}"
            payload-expression="#pathVariables.name">
    </int-htpp:inbound-gateway>

    <channel id="requestChannel"/>
    <channel id="replyChannel"/>

    <channel id="requestChannelCatalog"/>
    <channel id="replyChannelCatalog"/>

    <service-activator input-channel="requestChannel"
                       output-channel="replyChannel"
                       ref="channelHandler"
                       method="getPersonDataByPin"
                       requires-reply="true"/>

    <service-activator input-channel="requestChannelCatalog"
                       output-channel="replyChannelCatalog"
                       ref="channelHandler"
                       method="getCatalogByName"
                       requires-reply="true"/>

</beans:beans>